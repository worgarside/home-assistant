---
alias: /remote/basement-remote/single-right

id: remote_basement_remote_single_right

description: Set kitchen lights to occupied state brightness and disable automations

mode: single

max_exceeded: silent

trigger:
  - domain: mqtt
    platform: device
    device_id: d51d19b9f0b2a60cd270f6c99247aa1c
    type: action
    subtype: single_right

action:
  - alias: Set kitchen lights to occupied state brightness
    parallel:
      - service: light.turn_on
        target:
          entity_id:
            - light.kitchen_counter_lights
            - light.kitchen_spotlights
        data:
          brightness_pct: >-
            {{
              min(
                states('sensor.lighting_modifier') | int(70) *
                (1 if now().hour >= 23 or now().hour < 7 else 2.5),
                100
              )
            }}
          transition: 1

      - service: light.turn_on
        target:
          entity_id: light.kitchen_island
        data:
          # Keep kitchen island brighter for cooking
          brightness_pct: >-
            {{
              max(
                min(
                  states('sensor.lighting_modifier') | int(70) *
                  (1 if now().hour >= 23 or now().hour < 7 else 2.5),
                  100
                ),
                (40 if 12 <= now().hour < 23 else 0)
              )
            }}
          transition: 1

  - alias: Disable kitchen occupancy automation
    service: automation.turn_off
    target:
      entity_id: automation.binary_sensor_kitchen_occupancy_state_change
