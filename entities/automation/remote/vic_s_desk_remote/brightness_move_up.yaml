---
alias: /remote/vic-s-desk-remote/brightness-move-up

id: remote_vic_s_desk_remote_brightness_move_up

mode: single

max_exceeded: silent

trigger:
  - domain: mqtt
    platform: device
    device_id: 5a8f51703fadf155e2b1cf8468d2b247
    type: action
    subtype: brightness_move_up

action:
  - repeat:
      for_each: >-
        {%- set ns = namespace(lights=[]) %}
        {%- for e in area_entities('vic_s_office') %}
          {%- if e.startswith('light.') and state_attr(e, 'brightness') is not none %}
            {%- set ns.lights = ns.lights + [e] %}
          {%- endif %}
        {%- endfor %}
        {{ ns.lights }}
      sequence:
        - service: light.turn_on
          target:
            entity_id: "{{ repeat.item }}"
          data:
            brightness: >-
              {% if is_state(repeat.item, "on") %}
                {{ min(state_attr(repeat.item, "brightness") | int(64) + 32, 255) }}
              {% else %}
                32
              {% endif %}
