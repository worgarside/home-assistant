---
alias: /input-select/target-git-branch/select-option

id: input_select_target_git_branch_select_option

mode: queued

trigger:
  platform: state
  entity_id: input_select.target_git_branch

condition:
  - alias: Validate new branch selected
    condition: template
    value_template: "{{ trigger.to_state.state != states('sensor.current_git_branch') }}"

action:
  - service: shell_command.checkout_git_branch
    data:
      branch: "{{ trigger.to_state.state }}"
      api_token: !secret api_bearer_token
      entity_ids: sensor.current_git_branch,sensor.current_git_ref,sensor.remote_git_branches
