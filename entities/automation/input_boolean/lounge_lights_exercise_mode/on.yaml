---
alias: /input-boolean/lounge-lights-exercise-mode/on

id: input_boolean_lounge_lights_exercise_mode_on

description: Enable exercise mode - set lounge lights to 100% and disable occupancy automation

mode: single

trigger:
  - platform: state
    entity_id: input_boolean.lounge_lights_exercise_mode
    from: "off"
    to: "on"

action:
  - service: var.set
    target:
      entity_id: var.lounge_occupancy_automation_state_pre_exercise_mode
    data:
      attributes:
        automation.binary_sensor_lounge_occupancy_off: >-
          {{ states('automation.binary_sensor_lounge_occupancy_off') | bool(true) }}
        automation.binary_sensor_lounge_occupancy_on: >-
          {{ states('automation.binary_sensor_lounge_occupancy_on') | bool(true) }}
        automation.binary_sensor_lounge_occupancy_room_timeout: >-
          {{ states('automation.binary_sensor_lounge_occupancy_room_timeout') | bool(true) }}

  - service: light.turn_on
    alias: Turn all lounge lights to 100%
    target:
      area_id: lounge
    data:
      brightness_pct: 100
      transition: 1

  - service: automation.turn_off
    alias: Disable the occupancy automations
    target:
      entity_id:
        - automation.binary_sensor_lounge_occupancy_off
        - automation.binary_sensor_lounge_occupancy_on
        - automation.binary_sensor_lounge_occupancy_room_timeout
