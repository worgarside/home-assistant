---
alias: /switch/vic-s-electric-blanket/timeout

id: switch_vic_s_electric_blanket_timeout

description: Turn off Vic's electric blanket after timeout based on level

mode: restart

trigger:
  - platform: state
    entity_id: sensor.vic_s_electric_blanket_level

variables:
  level: "{{ states('sensor.vic_s_electric_blanket_level') }}"

condition: "{{ level in ['1', '2', '3'] }}"

action:
  - choose:
      - conditions: "{{ level == '1' }}"
        sequence:
          - delay:
              minutes: "{{ states('input_number.electric_blanket_timeout_level_1') | int(60) }}"
          - service: switch.turn_off
            target:
              entity_id: switch.vic_s_electric_blanket

      - conditions: "{{ level == '2' }}"
        sequence:
          - delay:
              minutes: "{{ states('input_number.electric_blanket_timeout_level_2') | int(60) }}"
          - service: switch.turn_off
            target:
              entity_id: switch.vic_s_electric_blanket

      - conditions: "{{ level == '3' }}"
        sequence:
          - delay:
              minutes: "{{ states('input_number.electric_blanket_timeout_level_3') | int(60) }}"
          - service: switch.turn_off
            target:
              entity_id: switch.vic_s_electric_blanket
