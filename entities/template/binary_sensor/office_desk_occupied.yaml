---
name: Office Desk Occupied
unique_id: office_desk_occupied
delay_off: '00:02:00'
icon: mdi:chair-rolling
state: >
  {{
    (
      states('binary_sensor.will_s_macbook_pro_docked') == 'on' and
      states('sensor.wills_macbook_pro_frontmost_app') not in [
        'loginwindow',
        'Screen Saver'
      ] and
      states('sensor.will_s_macbook_pro_last_update') | as_datetime >
        now() - timedelta(minutes=2)
    ) or (
      states('binary_sensor.st_macbook_pro_docked') == 'on' and
      states('sensor.st_macbook_pro_frontmost_app') not in [
        'loginwindow',
        'Screen Saver'
      ] and
      states('sensor.st_macbook_pro_last_update') | as_datetime >
        now() - timedelta(minutes=2)
    )
  }}
