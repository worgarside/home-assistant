---
description: Set the volume of the Topaz SR10 to a specific value

mode: restart

fields:
  volume_level:
    description: The volume level to set the Topaz SR10 to; 0.0 - 1.0
    required: true

sequence:
  - variables:
      initial_level: "{{ state_attr('media_player.topaz_sr10', 'volume_level') | float(0) }}"

      up_or_down: "{{ iif( initial_level | float > volume_level | float, 'down', 'up') }}"

      repeat_count: "{{ ( (initial_level | float - volume_level | float) | abs * 100 ) | int(0) }}"

  - repeat:
      count: "{{ repeat_count }}"
      sequence:
        - service: media_player.volume_{{ up_or_down }}
          target:
            entity_id: media_player.topaz_sr10
