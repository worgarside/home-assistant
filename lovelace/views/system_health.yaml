---
title: System Health

icon: mdi:medication

path: system_health

cards:
  - type: custom:vertical-stack-in-card
    cards:
      - type: custom:auto-entities
        card:
          type: entities
          title: Unavailable Entities
          show_header_toggle: false
        sort:
          method: domain
        filter:
          template: "{{ state_attr('sensor.count_unavailable_entities', 'entities') }}"
      - type: conditional
        conditions:
          - entity: binary_sensor.entities_are_unavailable
            state: "off"
        card:
          type: markdown
          content: Nothing to report here!
          style: |
            ha-card {
              box-shadow: none;
              border: none;
              margin-top: -32px;
            }

  - type: custom:vertical-stack-in-card
    cards:
      - type: custom:auto-entities
        card:
          type: entities
          title: Low Batteries
          show_header_toggle: false
        sort:
          method: domain
        filter:
          template: "{{ state_attr('sensor.count_low_batteries', 'entities') }}"
      - type: conditional
        conditions:
          - entity: binary_sensor.batteries_are_low
            state: "off"
        card:
          type: markdown
          content: All charged up!
          style: |
            ha-card {
              box-shadow: none;
              border: none;
              margin-top: -32px;
            }

  - type: custom:vertical-stack-in-card
    cards:
      - type: glance
        entities:
          - entity: sensor.count_automations
            name: Automations
          - entity: sensor.count_binary_sensors
            name: Binary Sensors
          - entity: sensor.count_device_trackers
            name: Devices
          - entity: sensor.count_input_booleans
            name: Input Booleans
          - entity: sensor.count_input_datetimes
            name: Input Datetimes
          - entity: sensor.count_input_numbers
            name: Input Numbers
          - entity: sensor.count_input_selects
            name: Input Selects
          - entity: sensor.count_input_texts
            name: Input Texts
          - entity: sensor.count_low_batteries
            name: Low Batteries
          - entity: sensor.count_scripts
            name: Scripts
          - entity: sensor.count_sensors
            name: Sensors
          - entity: sensor.count_switches
            name: Switches
          - entity: sensor.count_unavailable_entities
            name: Unavailable
          - entity: sensor.count_zones
            name: Zones

      - type: glance
        entities:
          - entity: sensor.database_size
            name: Database
          - entity: sensor.events_table_size
            name: Events Table Size
          - entity: sensor.state_attributes_table_size
            name: State Attributes Table Size
          - entity: sensor.states_table_size
            name: States Table Size
          - entity: sensor.statistics_table_size
            name: Statistics Table Size
          - entity: sensor.database_record_count
            name: Database Record Count
          - entity: sensor.events_table_record_count
            name: Events Table Record Count
          - entity: sensor.state_attributes_table_record_count
            name: State Attributes Table Record Count
          - entity: sensor.states_table_record_count
            name: States Table Record Count
          - entity: sensor.statistics_table_record_count
            name: Statistics Table Record Count

  - type: entities
    entities:
      - type: custom:fold-entity-row
        head:
          type: section
          label: Task Scheduler
          card_mod:
            style: |
              div.divider {
                display: none;
              }
              .label {
                font-size: 24px;
                font-weight: 400 !important;
                margin-bottom: 0px !important;
              }
        entities:
          - type: custom:vertical-stack-in-card
            cards:
              - type: entities
                entities:
                  - entity: input_text.task_scheduler_trigger_entity_id
                    name: Entity ID
                  - entity: input_text.task_scheduler_trigger_state
                    name: State
                  - entity: input_text.task_scheduler_service_call
                    name: Service Call
                  - entity: input_text.task_scheduler_repeat_count
                    name: Repeat Count
              - type: custom:lovelace-multiline-text-input-card
                entity: input_text.task_scheduler_service_kwargs
                placeholder_text: Add kwargs for the service call here (YAML format)
                title: Service Call Kwargs
                max_length: 255
                style: |
                  div.card-header, div > textarea.textarea {
                    background-color: var(--mdc-text-field-fill-color, whitesmoke);
                  }
                  div.card-header {
                    border-radius: 4px 4px 0 0;
                    padding: 0px 15px;
                    margin: 0 16px;
                    color: var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6));
                    font-size: 16px;
                    height: 40px;
                  }
                  div.card-content {
                    padding-bottom: 0px;
                  }
                  div.card-content > textarea.textarea {
                    margin-top: 8px;
                    padding-top: 8px;
                    padding-left: 16px;
                    width: calc(100% - 19px);
                    border-color: #00000000;
                    font-family: monospace;
                    border-bottom-width: 1px;
                    border-bottom-color: #828282;
                  }
                  div.card-content > textarea.textarea:focus {
                    background-color: #2D2D2D;
                    border-bottom-color: white;
                  }
                  div.card-content > span#spanMaxCharactersInfoText {
                    display: none;
                  }

          - type: button
            name: Schedule Task
            show_state: false
            icon: mdi:timer-play
            tap_action:
              action: call-service
              service: pyscript.create_task
      - type: custom:list-card
        entity: sensor.scheduled_tasks
        title: Scheduled Tasks
        feed_attribute: scheduledTasks
        columns:
          - title: Entity ID
            field: trigger_entity_id
          - title: Trigger State
            field: trigger_state
          - title: Service Call
            field: service_call
          - title: Kwargs
            field: service_kwargs
          - title: Runs Remaining
            field: runs_remaining

  - type: horizontal-stack
    title: Internet Speeds
    cards:
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.speedtest_download
            name: Download
        icon: mdi:download-network-outline
        line_color: blue
        line_width: 8
        font_size: 75
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.speedtest_upload
            name: Upload
        icon: mdi:upload-network-outline
        line_color: "#e74c3c"
        line_width: 8
        font_size: 75
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.speedtest_ping
            name: Ping
        line_color: var(--accent-color)
        line_width: 8
        font_size: 75

  - type: custom:vertical-stack-in-card
    cards:
      - type: horizontal-stack
        cards:
          - type: markdown
            content: "# Raspberry Pi Stats"
          - type: entities
            entities:
              - entity: input_select.pi_stats_legend_sensor_type
                name: Legend
                card_mod:
                  style:
                    hui-generic-entity-row:
                      $: |
                        state-badge {
                          display: none;
                        }
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: pi_stats_graph_card_template
            variables:
              - name: CPU Usage
              - sensor_suffix: _cpu_usage
              - hasspi_sensor: processor_use
              - upper_bound: ~75
              - icon: mdi:cpu-32-bit
          - type: custom:decluttering-card
            template: pi_stats_graph_card_template
            variables:
              - name: CPU Temperature
              - sensor_suffix: _cpu_temperature
              - hasspi_sensor: processor_temperature
              - upper_bound: 100
              - icon: mdi:thermometer-lines
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: pi_stats_graph_card_template
            variables:
              - name: Memory Usage
              - sensor_suffix: _memory_usage
              - hasspi_sensor: memory_use_percent
              - upper_bound: ~75
              - icon: mdi:memory
          - type: custom:decluttering-card
            template: pi_stats_graph_card_template
            variables:
              - name: Disk Usage
              - sensor_suffix: _disk_usage
              - hasspi_sensor: disk_use_percent
              - upper_bound: 100
              - icon: mdi:harddisk
      - type: conditional
        conditions:
          - entity: input_select.pi_stats_legend_sensor_type
            state: CPU Usage
        card:
          type: custom:decluttering-card
          template: pi_stats_legend_card_template
          variables:
            - sensor_suffix: _cpu_usage
            - hasspi_sensor: processor_use
      - type: conditional
        conditions:
          - entity: input_select.pi_stats_legend_sensor_type
            state: CPU Temperature
        card:
          type: custom:decluttering-card
          template: pi_stats_legend_card_template
          variables:
            - sensor_suffix: _cpu_temperature
            - hasspi_sensor: processor_temperature
      - type: conditional
        conditions:
          - entity: input_select.pi_stats_legend_sensor_type
            state: Memory Usage
        card:
          type: custom:decluttering-card
          template: pi_stats_legend_card_template
          variables:
            - sensor_suffix: _memory_usage
            - hasspi_sensor: memory_use_percent
      - type: conditional
        conditions:
          - entity: input_select.pi_stats_legend_sensor_type
            state: Disk Usage
        card:
          type: custom:decluttering-card
          template: pi_stats_legend_card_template
          variables:
            - sensor_suffix: _disk_usage
            - hasspi_sensor: disk_use_percent
      - type: horizontal-stack
        cards:
          - type: entities
            show_state: false
            entities:
              - entity: binary_sensor.clmtpi_online
                name: ClmtPi
                style: |
                  :host {
                    --card-mod-icon-color:
                      {% if states("binary_sensor.clmtpi_online") == "on" %}
                        #FF9800;
                      {% else %}
                        var(--paper-item-icon-color, #44739e);
                      {% endif %}
                  }
              - entity: binary_sensor.crtpi_online
                name: CRTPi
                style: |
                  :host {
                    --card-mod-icon-color:
                      {% if states("binary_sensor.crtpi_online") == "on" %}
                        #02D1D1;
                      {% else %}
                        var(--paper-item-icon-color, #44739e);
                      {% endif %}
                  }
              - entity: binary_sensor.growpi_online
                name: GrowPi
                style: |
                  :host {
                    --card-mod-icon-color:
                      {% if states("binary_sensor.growpi_online") == "on" %}
                        #E74B3B;
                      {% else %}
                        var(--paper-item-icon-color, #44739e);
                      {% endif %}
                  }
          - type: entities
            entities:
              - entity: binary_sensor.hasspi_online
                name: HAssPi
                style: |
                  :host {
                    --card-mod-icon-color:
                      {% if states("binary_sensor.hasspi_online") == "on" %}
                        #9B59B6;
                      {% else %}
                        var(--paper-item-icon-color, #44739e);
                      {% endif %}
                  }
              - entity: binary_sensor.mtrxpi_online
                name: MtrxPi
                style: |
                  :host {
                    --card-mod-icon-color:
                      {% if states("binary_sensor.mtrxpi_online") == "on" %}
                        #F1C40E;
                      {% else %}
                        var(--paper-item-icon-color, #44739e);
                      {% endif %}
                  }
              - entity: binary_sensor.vsmppi_online
                name: VSMPPi
                style: |
                  :host {
                    --card-mod-icon-color:
                      {% if states("binary_sensor.vsmppi_online") == "on" %}
                        #029E44;
                      {% else %}
                        var(--paper-item-icon-color, #44739e);
                      {% endif %}
                  }
