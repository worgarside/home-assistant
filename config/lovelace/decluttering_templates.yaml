---

active_media_player_template:
  default:
    icon: speaker
  card:
    type: conditional
    conditions:
      - entity: "binary_sensor.[[binary_sensor_name]]_active"
        state: "on"
    card:
      type: custom:mini-media-player
      entity: "media_player.[[media_player]]"
      icon: "mdi:[[icon]]"
      artwork: cover
      hide:
        volume: true
        power_state: false

tfl_service_warning_template:
  card:
    type: conditional
    conditions:
      - entity: "sensor.[[tfl_line]]"
        state_not: "Good Service"
    card:
      type: entities
      card_mod:
        style: |
          ha-card { 
            --ha-card-background: 
            {% if "good service" in (states("sensor.[[tfl_line]]") | lower) %}
              #007229;
            {% elif "minor delays" in (states("sensor.[[tfl_line]]") | lower) %}
              #BA6F08;
            {% elif "part closure" in (states("sensor.[[tfl_line]]") | lower) %}
              #BA6F08;
            {% elif "part suspended" in (states("sensor.[[tfl_line]]") | lower) %}
              #BA6F08;
            {% elif "planned closure" in (states("sensor.[[tfl_line]]") | lower) %}
              #D80000;
            {% elif "reduced service" in (states("sensor.[[tfl_line]]") | lower) %}
              #BA6F08;
            {% elif "service closed" in (states("sensor.[[tfl_line]]") | lower) %}
              #D80000;
            {% elif "severe delays" in (states("sensor.[[tfl_line]]") | lower) %}
              #D80000;
            {% elif "special service" in (states("sensor.[[tfl_line]]") | lower) %}
              #BA6F08;
            {% elif "suspended" in (states("sensor.[[tfl_line]]") | lower) %}
              #D80000;
            {% else %}
              #FFFFFF;
            {% endif %}
            margin: 10px;
          }
      entities:
        - entity: "sensor.[[tfl_line]]"
          card_mod:
            style: |
              :host {
                --card-mod-icon-color: black;
              }

london_air_quality_inner_template:
  card:
    type: conditional
    conditions:
      - entity: "sensor.[[borough]]"
        state: "[[state]]"
    card:
      type: entities
      card_mod:
        style: |
          ha-card {
            box-shadow: none;
            --ha-card-background: [[bg_color]];
          }
            #states {
            padding: 6px 8px;
          }
      entities:
        - entity: "sensor.[[borough]]"
          style:
            hui-generic-entity-row:
              $: |
                state-badge, div.text-content:not(.info) {
                  display: none;
                }

# "binary_sensor.london_air_{{ '[[state]]' | lower | replace(' ', '_') }}_active"
london_air_quality_outer_template:
  card:
    type: conditional
    conditions:
      - entity: "[[conditional_sensor]]"
        state: "on"
    card:
      type: custom:layout-card
      layout_type: custom:horizontal-layout
      layout:
        width: 150
        max_cols: 2
      cards:
        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: barking_and_dagenham
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: bexley
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: brent
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: camden
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: city_of_london
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: croydon
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: ealing
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: enfield
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: greenwich
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: hackney
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: haringey
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: harrow
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: havering
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: hillingdon
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: islington
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: kensington_and_chelsea
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: kingston
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: lambeth
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: lewisham
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: merton
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: redbridge
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: richmond
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: southwark
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: sutton
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: tower_hamlets
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: wandsworth
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"

        - type: custom:decluttering-card
          template: london_air_quality_inner_template
          variables:
            - borough: westminster
            - state: "[[state]]"
            - bg_color: "[[bg_color]]"
